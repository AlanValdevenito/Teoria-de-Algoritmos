# Enunciado

El problema de Camino Hamiltoniano con inicio y fin es el siguiente: Dado un grafo, un vértice de inicio y otro de fin, ¿existe un
camino Hamiltoniano dentro del grafo que empiece en el vértice de inicio y termine en el vértice de fin?.

Demostrar que el problema de Camino Hamiltoniano con inicio y fin es un problema NP-Completo. Recomendamos recordar que el
problema de Camino Hamiltoniano es un problema NP-Completo.

El problema de Camino Hamiltoniano es el siguiente: Dado un grafo, ¿existe un camino que visite cada vertice de G exactamente una vez?.

# Demostracion

Notacion:
- Camino Hamiltoniano con inicio y fin: CHIF
- Camino Hamiltoniano: CH

Para demostrar que el problema de CHIF es un problema NP-Completo debemos:
- Demostrar que el problema se encuentra en NP
- Reducir el problema de CH al problema de CHIF: CH $\leq_P$ CHIF

Nota: Para la segunda demostracion es importante demostrar que nuestra reduccion es correcta demostrando la doble implicacion.

La segunda demostracion nos indica que el problema de CHIF es al menos tan dificil de resolver como el problema de CH. Esto significa que resolver el problema de CH puede ser transformado en resolver el problema de CHIF.

## Demostracion I: El problema se encuentra en NP

Para que el problema se encuentre en NP, debe haber un verificador eficiente.

En otras palabras, debe haber un verificador que ejecute en tiempo polinomial.

Verificador: Recibe una instancia del problema y una solucion.

```py
def verificador(grafo, inicio, fin, camino):
    vertices = set(grafo.obtener_vertices())

    visitados = set()

    # Validamos que la cantidad de vertices en el camino sea igual a la cantidad de vertices en el grafo
    if len(camino) != len(vertices): return False

    for v in camino:
        # Validamos que cada vertice del camino pertenezca a los vertices el grafo
        if v not in vertices: return False

        # Validamos que cada vertice del camino se visite una unica vez
        if v in visitados: return False

        visitados.add(v)

    # Validamos que el vertice i este unido al vertice i+1 de tal forma que se forme un camino
    for i in range(1, len(camino)):
        v = camino[i-1]
        w = camino[i]

        if not grafo.estan_unidos(v,w): return False

    # Validamos que el camino comience en el vertice inicio
    if camino[0] != inicio: return False

    # Validamos que el camino finalice en el vertice fin
    if camino[-1] != fin: return False

    return True
```

Complejidad: La complejidad resulta ser O(V) con V la cantidad de vertices del camino
- Validar que la cantidad de vertices en el camino sea igual a la cantidad de vertices en el grafo es O(1)
- Validar que cada vertice del camino pertenezca al grafo tiene una complejidad de O(V) con V la cantidad de vertices del camino
- Validar que cada vertice del camino se visita una unica vez tiene una complejidad de O(V) con V la cantidad de vertices del camino
- Validar que el vertice i este unido al vertice i+1 de tal forma que se forme un camino tiene una complejidad de O(V) con V la cantidad de vertices del camino
- Validar que el camino comience en el vertice inicio y finalice en el vertice fin tiene una complejidad de O(1)

Luego, se ejecuta en tiempo polinomial, lo cual quiere decir que el problema se encuentra en NP.

## Demostracion II: Reduccion de un problema NP-Completo

Debemos demostrar que CH $\leq_P$ CHIF.

### Reduccion planteada

¿Podemos resolver el problema de CH utilizando la solucion del problema de CHIF?.

Vamos a utilizar una caja negra que resuelve el problema de CHIF para resolver el problema de CH.

El problema de CH recibe un grafo G'.

Transformacion del problema: Transformamos la entrada del problema de CH en una entrada del problema CHIF
- El grafo G' del problema de CH coincide con el grafo G del problema de CHIF
- Seleccionamos un vertice inicio s y un vertice fin t, teniendo en cuenta que el inicio y fin deben ser vertices distintos

Particularmente para este caso se invoca una cantidad cuadratica de veces a la caja negra que resuelve el problema de CHIF para cada inicio y fin posible. Luego, como hay una cantidad cuadratica de pares tenemos que esta transformacion requiere una cantidad de pasos polinomiales. 

A continuacion, para demostrar que la reduccion es correcta, debemos demostrar que:

Hay solucion de CH, si y solo si, hay solucion para el problema de CHIF.

Para demostrar ambas implicaciones tenemos dos opciones:
- Metodo directo, asumiendo para cada una que la hipotesis es cierta.
- Metodo por absurdo.

### Si hay CHIF, entonces hay CH

Hipotesis: Existe un camino Hamiltoniano dentro del grafo que empiece en el vértice de inicio s y termine en el vértice de fin t en G
Tesis: Existe un camino que visite cada vertice de G' exactamente una vez

El camino Hamiltoniano que va de s a t visita todos los vertices de G exactamente una vez.

Luego, este mismo camino es tambien una solucion al problema de CH, ya que CH no impone restricciones sobre vertices de inicio o fin.

Por lo tanto, si existe solucion para CHIF, entonces existe solucion para CH.

Nota: No estamos cualquier instancia posible de CHIF, sino una que resulta de la reduccion planteada.

### Si hay CH, entonces hay CHIF

Hipotesis: Existe un camino que visite cada vertice de G' exactamente una vez
Tesis: Existe un camino Hamiltoniano dentro del grafo que empiece en el vértice de inicio s y termine en el vértice de fin t en G

El camino hamiltoniano que resuelve CH es un camino que pasa por todos los vertices exactamente una vez.

Este camino necesariamente tiene un primer vertice s y un ultimo vertice t.

Luego, hay al menos una instancia valida de CHIF (con inicio s y fin t) que tambien tiene solucion.

Por lo tanto, si existe solucion para CH, entonces existe solucion para CHIF.

Nota: No estamos cualquier instancia posible de CHIF, sino una que resulta de la reduccion planteada.

# Conclusion

Habiendo demostrado que la reduccion es correcta, queda demostrado tambien que el problema de CHIF es un problema NP-Completo.